{% extends 'base.html' %}

{% block title %}
  page3
{% endblock %}

{% block content %}
  <script>
    function submitAnswers_page3() {
      var line_number = document.getElementById('line_number').value
    
      // Проверка на заполнение поля формы
      if (line_number === '') {
        alert('Заполните поле формы')
        return
      }
    
      // Отправить данные на сервер
      fetch('/check', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ line_number })
      })
        .then((response) => response.json())
        .then((data) => {
          // Обновить содержимое блока <h3> с данными из сервера
          document.getElementById('csv_data_row').innerText = data.data_csv_row
    
          // Вывести информацию в блок info-of-block
          document.getElementById('info-of-block').innerHTML = generateBlockInfoHTML(data)
    
          // Сбросить значения полей формы
          document.getElementById('line_number').value = ''
        })
        .catch((error) => {
          console.error('Ошибка:', error)
          alert('Произошла ошибка при обращении к серверу')
        })
    }
    
    function generateBlockInfoHTML(data) {
      return `
                <p class="data-about-the-block"><a style="font-weight: bolder;">Материал:</a> &nbsp; ${data.material}</p>
                <p class="data-about-the-block"><a style="font-weight: bolder;">Тип:</a> &nbsp; ${data.tipe}</p>
                <p class="data-about-the-block"><a style="font-weight: bolder;">Стандарт:</a> &nbsp; ${data.standard}</p>
                <p class="data-about-the-block"><a style="font-weight: bolder;">Диаметр, мм:</a> &nbsp; ${data.diameter}</p>
                <p class="data-about-the-block"><a style="font-weight: bolder;">Длина, мм:</a> &nbsp; ${data.length}</p>
                <p class="data-about-the-block"><a style="font-weight: bolder;">Количество, шт:</a> &nbsp; ${data.quantity}</p>
                `
    }
  </script>

  <h1>page3</h1>

  <div class="wrapper">
    <div class="input-line_number-container">
      <input type="number" id="line_number" />
    </div>

    <br />

    <div onclick="submitAnswers_page3()">
      <button id="btn-confirm-of-input-line_number-container">Отправить</button>
    </div>

    <div id="info-of-block" style="text-align: center;"></div>

    <h3 id="csv_data_row"></h3>
  </div>

  <link href="{{ url_for('static', filename = 'scc/style_stellazh.css') }}" rel="stylesheet" type="text/css" />
{% endblock %}
